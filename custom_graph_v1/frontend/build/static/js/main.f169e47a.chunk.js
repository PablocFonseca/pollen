(this.webpackJsonpstreamlit_custom_graph=this.webpackJsonpstreamlit_custom_graph||[]).push([[0],{14:function(t,e,a){t.exports=a(30)},30:function(t,e,a){"use strict";a.r(e);var r=a(2),s=a.n(r),o=a(12),n=a.n(o),i=a(7),l=a(8),c=a.n(l),h=a(9),p=a(6),d=a.n(p),g=(a(25),a(32)),m=i.a.CanvasJSChart,u=i.a.CanvasJS;const x=[[],[],[],[],[],[],[],[],[],[]];d.a.options={positionClass:"toast-top-full-width",hideDuration:300,timeOut:3e3};class _ extends r.Component{constructor(t){super(t),this.updateChart=this.updateChart.bind(this),this.toggleDataSeries=this.toggleDataSeries.bind(this)}componentDidMount(){const{kwargs:t}=this.props.args,{y_axis:e,api:a,y_max:r,refresh_sec:s,graph_height:o}=t;h.a.setFrameHeight(),this.updateChart(),s&&setInterval(this.updateChart,1e3*s)}toggleDataSeries(t){"undefined"===typeof t.dataSeries.visible||t.dataSeries.visible?t.dataSeries.visible=!1:t.dataSeries.visible=!0,this.chart.render()}async fetchGraphData(){const{kwargs:t}=this.props.args,{y_axis:e,api:a,y_max:r,refresh_sec:s}=t,o=await g.a.post(a,{...t});return JSON.parse(o.data)}async updateChart(){const{kwargs:t}=this.props.args,{x_axis:e,y_axis:a,api:r,y_max:s,refresh_sec:o,refresh_button:n,theme_options:i}=t;try{const t=await this.fetchGraphData(),r=[];for(a.map((a,s)=>r[s]=t.map((r,s)=>s==t.length-1&&i.showInLegendPerLine?{x:r[e.field],y:r[a.field],indexLabel:a.name+" "+r[a.field].toFixed(3)+"                        \n.",indexLabelFontColor:a.color}:{x:r[e.field],y:r[a.field]}));x[0].length;)a.map((t,e)=>{x[e].pop()});console.log("fetchGraphData",x),a.map((t,e)=>{x[e].push(...r[e]),this.chart.options.data[e].legendText=t.name+r[e].pop().y}),this.chart.render(),n&&!o&&d.a.success("Success!")}catch(l){n&&!o&&d.a.error("Fetch Error: ".concat(l.message))}}render(){const t=[],{kwargs:e}=this.props.args,{y_axis:a,api:r,y_max:o,refresh_sec:n,theme_options:i,refresh_button:l}=e,h=a.map((e,a)=>(t.push(e.color),{type:"spline",xValueFormatString:"#.##0 ",yValueFormatString:"#.##0",showInLegend:i.showInLegend,name:e.name,dataPoints:x[a]}));u.addColorSet("greenShades",t);const p={colorSet:"greenShades",backgroundColor:i.backgroundColor?i.backgroundColor:"white",zoomEnabled:!0,title:{text:i.main_title?i.main_title:""},axisX:{title:i.x_axis_title?i.x_axis_title:"",labelFormatter:t=>c()(t.value).format("DD/MM/YYYY hh"),labelFontSize:12},axisY:{suffix:"",maximum:o||null,gridColor:i.grid_color?i.grid_color:""},toolTip:{shared:!0,contentFormatter:function(t){let e="";const a=c()(t.entries[0].dataPoint.x).format("DD/MM/YYYY HH:mm");e+="<strong>Date</strong>: ".concat(a,"<br/>");for(let r=1;r<t.entries.length;r++){const a=t.entries[r],s=a.dataSeries,o=a.dataPoint,n=s.color?s.color:s.options.color;e+='<strong style="color: '.concat(n,'">').concat(s.name,"</strong>: ").concat(o.y,"<br/>")}return e}},legend:{cursor:"pointer",verticalAlign:"top",fontSize:18,fontColor:"dimGrey",itemclick:this.toggleDataSeries},data:h,height:e.graph_height?e.graph_height:400};return s.a.createElement("div",null,l&&!n&&s.a.createElement("div",{style:{display:"flex"}},s.a.createElement("div",{style:{margin:"10px 10px 10px 2px"}},s.a.createElement("button",{className:"btn btn-warning",onClick:this.updateChart},"Refresh"))),s.a.createElement(m,{options:p,onRef:t=>this.chart=t}))}}var f=Object(h.b)(_);n.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(f,null)),document.getElementById("root"))}},[[14,1,2]]]);
//# sourceMappingURL=main.f169e47a.chunk.js.map